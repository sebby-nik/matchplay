<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Events</title>
    <meta
      name="description"
      content="Upcoming matchplay team events, including Ryder Cup and Presidents Cup schedules, venues, and dates."
    />
    <meta property="og:site_name" content="Matchplay Rankings" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Events | Matchplay Rankings" />
    <meta
      property="og:description"
      content="Upcoming matchplay team events, including Ryder Cup and Presidents Cup schedules, venues, and dates."
    />
    <meta property="og:url" content="https://www.matchplayrankings.com/events.html" />
    <meta
      property="og:image"
      content="https://www.matchplayrankings.com/assets/matchplay-rory.avif"
    />
    <meta property="og:image:width" content="640" />
    <meta property="og:image:height" content="637" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Events | Matchplay Rankings" />
    <meta
      name="twitter:description"
      content="Upcoming matchplay team events, including Ryder Cup and Presidents Cup schedules, venues, and dates."
    />
    <meta
      name="twitter:image"
      content="https://www.matchplayrankings.com/assets/matchplay-rory.avif"
    />
    <link rel="canonical" href="https://www.matchplayrankings.com/events.html" />
    <link rel="icon" type="image/png" href="assets/favicon.png" />
    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=Instrument+Serif:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav class="site-nav">
      <div class="site-nav__inner">
        <button class="site-nav__toggle" type="button" aria-expanded="false" aria-controls="siteNavLinks">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <div class="site-nav__links" id="siteNavLinks">
          <a class="site-nav__link" href="index.html">Player Ratings</a>
          <a class="site-nav__link" href="records.html">Player Records</a>
          <a class="site-nav__link" href="lineal.html">Lineal Championship</a>
          <a class="site-nav__link is-active" href="events.html">Events</a>
          <a class="site-nav__link" href="faq.html">FAQs</a>
          <a class="site-nav__link" href="about.html">About Us</a>
        </div>
      </div>
    </nav>
    <div class="site-nav__backdrop" id="siteNavBackdrop"></div>

    <header class="hero hero--sport">
      <div class="hero__content hero__content--wide">
        <p class="eyebrow">Upcoming Fixtures</p>
        <div class="hero__title-row">
          <h1>Matchplay Events</h1>
        </div>
        <p class="lede">
          The calendar below tracks upcoming Matchplay events and shows the results of all past Matchplay events in the dataset, sorted by date with venues and event
          details in one place.
        </p>
      </div>
    </header>

    <section class="schedule">
      <div class="schedule__toggle" role="tablist" aria-label="Events view">
        <button class="schedule__toggle-btn is-active" type="button" data-view="upcoming" role="tab" aria-selected="true">
          Upcoming
        </button>
        <button class="schedule__toggle-btn" type="button" data-view="results" role="tab" aria-selected="false">
          Results
        </button>
      </div>

      <div class="schedule__panel is-active" data-panel="upcoming" role="tabpanel" aria-live="polite">
        <div class="schedule__loading">Loading upcoming events…</div>
      </div>

      <div class="schedule__panel" data-panel="results" role="tabpanel" aria-live="polite">
        <div class="schedule__loading">Loading results…</div>
      </div>
    </section>

    <script src="app.js"></script>
    <script>
      const setScheduleView = (view) => {
        const scheduleButtons = Array.from(document.querySelectorAll(".schedule__toggle-btn"));
        const schedulePanels = Array.from(document.querySelectorAll(".schedule__panel"));
        scheduleButtons.forEach((btn) => {
          const active = btn.dataset.view === view;
          btn.classList.toggle("is-active", active);
          btn.setAttribute("aria-selected", active ? "true" : "false");
        });
        schedulePanels.forEach((panel) => {
          panel.classList.toggle("is-active", panel.dataset.panel === view);
        });
      };

      const scheduleToggle = document.querySelector(".schedule__toggle");
      if (scheduleToggle) {
        scheduleToggle.addEventListener("click", (event) => {
          const button = event.target.closest(".schedule__toggle-btn");
          if (!button) return;
          event.preventDefault();
          setScheduleView(button.dataset.view);
        });
      }

      setScheduleView("upcoming");

      const MONTH_ORDER = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December"
      ];

      const logoMap = {
        "Ryder Cup": "assets/ryder-cup-logo.png",
        "Presidents Cup": "assets/presidents-cup-logo.png"
      };

      const initialsForEvent = (eventName) => {
        return eventName
          .split(" ")
          .filter((part) => part.length)
          .map((part) => part[0])
          .slice(0, 3)
          .join("")
          .toUpperCase();
      };

      const buildEventList = (matches) => {
        const entries = new Map();
        matches.forEach((match) => {
          const key = `${match.event}-${match.year}-${match.month || ""}`;
          if (!entries.has(key)) {
            entries.set(key, {
              event: match.event,
              year: match.year,
              month: match.month || "January",
              venue: ""
            });
          }
        });

        return Array.from(entries.values());
      };

      const sortByDateDesc = (list) => {
        return list.sort((a, b) => {
          if (a.dateStart && b.dateStart) return b.dateStart.localeCompare(a.dateStart);
          if (a.year !== b.year) return b.year - a.year;
          return MONTH_ORDER.indexOf(b.month) - MONTH_ORDER.indexOf(a.month);
        });
      };

      const sortByDateAsc = (list) => {
        return list.sort((a, b) => {
          if (a.dateStart && b.dateStart) return a.dateStart.localeCompare(b.dateStart);
          if (a.year !== b.year) return a.year - b.year;
          return MONTH_ORDER.indexOf(a.month) - MONTH_ORDER.indexOf(b.month);
        });
      };

      const splitByTime = (list) => {
        const now = new Date();
        const currentYear = now.getFullYear();
        const currentMonthIndex = now.getMonth();

        const past = [];
        const future = [];

        list.forEach((item) => {
          const monthIndex = MONTH_ORDER.indexOf(item.month);
          const isPast = item.year < currentYear || (item.year === currentYear && monthIndex <= currentMonthIndex);
          if (isPast) {
            past.push(item);
          } else {
            future.push(item);
          }
        });

        return { past, future };
      };

      const renderSchedule = (panelKey, items, emptyMessage) => {
        const panel = document.querySelector(`.schedule__panel[data-panel='${panelKey}']`);
        panel.innerHTML = "";

        if (!items.length) {
          panel.innerHTML = `<p class="schedule__empty">${emptyMessage}</p>`;
          return;
        }

        let currentYear = null;
        items.forEach((item) => {
          if (item.year !== currentYear) {
            currentYear = item.year;
            const group = document.createElement("div");
            group.className = "schedule__group";
            group.innerHTML = `\n              <div class=\"schedule__heading\">\n                <h2>${currentYear}</h2>\n              </div>\n              <div class=\"schedule__cards\"></div>\n            `;\n            panel.appendChild(group);\n          }

          const groupCards = panel.lastElementChild.querySelector(".schedule__cards");
          const card = document.createElement("article");
          const logo = logoMap[item.event];
          card.className = "schedule__card schedule__card--logo";

          const dateLabel = item.dateLabel || `${item.month} ${item.year}`;
          const venueLabel = item.venue || "";

          card.innerHTML = `\n            <div class=\"schedule__logo\">\n              ${logo ? `<img src=\"${logo}\" alt=\"${item.event} logo\" />` : `<span class=\"schedule__logo-text\">${initialsForEvent(item.event)}</span>`}\n            </div>\n            <h3>${item.event} ${item.year}</h3>\n            <p class=\"schedule__meta schedule__meta--empty\">${venueLabel || \"&nbsp;\"}</p>\n            <div class=\"schedule__date\">${dateLabel}</div>\n          `;\n          groupCards.appendChild(card);\n        });\n      };

      fetch("data.json")
        .then((response) => response.json())
        .then((data) => {
          const matchEvents = buildEventList(data.matches || []);
          const futureEvents = Array.isArray(data.events) ? data.events : [];
          const allEvents = [...matchEvents, ...futureEvents];
          const { past, future } = splitByTime(allEvents);
          renderSchedule("upcoming", sortByDateAsc(future), "No upcoming events listed yet.");
          renderSchedule("results", sortByDateDesc(past), "No past events listed yet.");
        })
        .catch(() => {
          const upcomingPanel = document.querySelector(".schedule__panel[data-panel='upcoming']");
          const resultsPanel = document.querySelector(".schedule__panel[data-panel='results']");
          if (upcomingPanel) {
            upcomingPanel.innerHTML = "<p class=\"schedule__empty\">Unable to load upcoming events.</p>";
          }
          if (resultsPanel) {
            resultsPanel.innerHTML = "<p class=\"schedule__empty\">Unable to load past events.</p>";
          }
        });
    </script>
  </body>
</html>
